require "./setup"
tp Swars::Battle.create!.memberships.first.info
params = {tag: "居飛車", rule_key: "ten_min"}
params = {rule_key: "ten_min"}
instance = QuickScript::Swars::GradeHistogramScript.new(params, {_method: "post"})
instance.call # => {:_component=>"QuickScriptViewValueAsV", :_v_bind=>{:value=>[{:_component=>"CustomChart", :_v_bind=>{:params=>{:data=>{:labels=>["9", "8", "7", "6", "5", "4", "3", "2", "1", "初", "二", "三", "四", "五", "六", "七", "八", "九"], :datasets=>[{:label=>nil, :data=>[67, 128, 330, 825, 1457, 2339, 3458, 5180, 5932, 4714, 3083, 1254, 494, 123, 37, 1, 1, 0]}]}, :scales_yAxes_ticks=>nil, :scales_yAxes_display=>false}}, :style=>{"max-width"=>"800px", :margin=>"auto"}, :class=>"is-unselectable is-centered"}, {:_component=>"QuickScriptViewValueAsTable", :_v_bind=>{:value=>{:rows=>[{"棋力"=>"九段", "人数"=>0, "割合"=>"0.00 %", "上位"=>"0.00 %", "偏差値"=>"94"}, {"棋力"=>"八段", "人数"=>1, "割合"=>"0.00 %", "上位"=>"0.00 %", "偏差値"=>"89"}, {"棋力"=>"七段", "人数"=>1, "割合"=>"0.00 %", "上位"=>"0.01 %", "偏差値"=>"84"}, {"棋力"=>"六段", "人数"=>37, "割合"=>"0.13 %", "上位"=>"0.13 %", "偏差値"=>"80"}, {"棋力"=>"五段", "人数"=>123, "割合"=>"0.42 %", "上位"=>"0.55 %", "偏差値"=>"75"}, {"棋力"=>"四段", "人数"=>494, "割合"=>"1.68 %", "上位"=>"2.23 %", "偏差値"=>"71"}, {"棋力"=>"三段", "人数"=>1254, "割合"=>"4.26 %", "上位"=>"6.49 %", "偏差値"=>"66"}, {"棋力"=>"二段", "人数"=>3083, "割合"=>"10.48 %", "上位"=>"16.97 %", "偏差値"=>"62"}, {"棋力"=>"初段", "人数"=>4714, "割合"=>"16.02 %", "上位"=>"32.99 %", "偏差値"=>"57"}, {"棋力"=>"1級", "人数"=>5932, "割合"=>"20.16 %", "上位"=>"53.15 %", "偏差値"=>"52"}, {"棋力"=>"2級", "人数"=>5180, "割合"=>"17.61 %", "上位"=>"70.76 %", "偏差値"=>"48"}, {"棋力"=>"3級", "人数"=>3458, "割合"=>"11.75 %", "上位"=>"82.51 %", "偏差値"=>"43"}, {"棋力"=>"4級", "人数"=>2339, "割合"=>"7.95 %", "上位"=>"90.46 %", "偏差値"=>"39"}, {"棋力"=>"5級", "人数"=>1457, "割合"=>"4.95 %", "上位"=>"95.41 %", "偏差値"=>"34"}, {"棋力"=>"6級", "人数"=>825, "割合"=>"2.80 %", "上位"=>"98.22 %", "偏差値"=>"29"}, {"棋力"=>"7級", "人数"=>330, "割合"=>"1.12 %", "上位"=>"99.34 %", "偏差値"=>"25"}, {"棋力"=>"8級", "人数"=>128, "割合"=>"0.44 %", "上位"=>"99.77 %", "偏差値"=>"20"}, {"棋力"=>"9級", "人数"=>67, "割合"=>"0.23 %", "上位"=>"100.00 %", "偏差値"=>"16"}], :always_table=>true}}}]}, :style=>{"gap"=>"0rem"}}
tp instance.records
# >> |--------------------+--------------------------|
# >> |                 ID | 100029060                |
# >> |               先後 | ▲                       |
# >> |               勝敗 | 勝ち                     |
# >> |               棋力 | 30級                     |
# >> |               力差 | 0                        |
# >> |           スタイル | 王道                     |
# >> |               自分 | user967104 30級          |
# >> |               相手 | user967105 30級          |
# >> |                 対 | 100029061                |
# >> |   defense_tag_list |                          |
# >> |    attack_tag_list | 新嬉野流                 |
# >> | technique_tag_list |                          |
# >> |      note_tag_list | 対振り飛車 居飛車 対抗形 |
# >> |--------------------+--------------------------|
# >> |------+------+------------------------+------------------------+--------+----------------------+--------------------|
# >> | 階級 | 度数 | 相対度数               | 累計相対度数           | 階級値 | 基準値               | 偏差値             |
# >> |------+------+------------------------+------------------------+--------+----------------------+--------------------|
# >> | 九段 |    0 |                    0.0 |                    0.0 |      0 |    4.366863233851693 |  93.66863233851693 |
# >> | 八段 |    1 | 3.3987016959521466e-05 | 3.3987016959521466e-05 |     -1 |   3.9076804990818683 |  89.07680499081869 |
# >> | 七段 |    1 | 3.3987016959521466e-05 |  6.797403391904293e-05 |     -2 |   3.4484977643120445 |  84.48497764312044 |
# >> | 六段 |   37 |  0.0012575196275022942 |   0.001325493661421337 |     -3 |     2.98931502954222 |   79.8931502954222 |
# >> | 五段 |  123 |    0.00418040308602114 |   0.005505896747442477 |     -4 |    2.530132294772396 |  75.30132294772396 |
# >> | 四段 |  494 |   0.016789586378003603 |   0.022295483125446082 |     -5 |    2.070949560002572 |  70.70949560002572 |
# >> | 三段 | 1254 |    0.04261971926723991 |      0.064915202392686 |     -6 |   1.6117668252327477 |  66.11766825232748 |
# >> | 二段 | 3083 |    0.10478197328620467 |    0.16969717567889067 |     -7 |   1.1525840904629236 | 61.525840904629234 |
# >> | 初段 | 4714 |    0.16021479794718418 |    0.32991197362607483 |     -8 |   0.6934013556930995 |  56.93401355693099 |
# >> | 1級  | 5932 |    0.20161098460388133 |     0.5315229582299561 |     -9 |  0.23421862092327536 |  52.34218620923275 |
# >> | 2級  | 5180 |    0.17605274785032118 |     0.7075757060802773 |    -10 | -0.22496411384654877 | 47.750358861534515 |
# >> | 3級  | 3458 |    0.11752710464602521 |     0.8251028107263025 |    -11 |  -0.6841468486163729 |  43.15853151383627 |
# >> | 4級  | 2339 |     0.0794956326683207 |     0.9045984433946233 |    -12 |   -1.143329583386197 |  38.56670416613803 |
# >> | 5級  | 1457 |    0.04951908371002277 |      0.954117527104646 |    -13 |  -1.6025123181560212 |  33.97487681843979 |
# >> | 6級  |  825 |   0.028039288991605207 |     0.9821568160962513 |    -14 |  -2.0616950529258453 | 29.383049470741547 |
# >> | 7級  |  330 |   0.011215715596642082 |     0.9933725316928933 |    -15 |  -2.5208777876956696 | 24.791222123043305 |
# >> | 8級  |  128 |   0.004350338170818748 |     0.9977228698637121 |    -16 |  -2.9800605224654935 | 20.199394775345066 |
# >> | 9級  |   67 |   0.002277130136287938 |                    1.0 |    -17 |  -3.4392432572353178 |  15.60756742764682 |
# >> |------+------+------------------------+------------------------+--------+----------------------+--------------------|
