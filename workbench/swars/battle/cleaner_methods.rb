require "./setup"

# battle = Swars::Battle.create! do |e|
#   e.memberships.build(user: Swars::User.create!)
# end
# # # Swars::Battle.eager_load(:memberships).merge(Swars::Membership.user_only([]))
# # record = Swars::Battle.scope_for_cleaner2.first
# battle.destroy!                 # => #<Swars::Battle id: 50132123, key: "df0dab19ee3d90eefed9c9c8ebe5c117", battled_at: "2024-07-05 23:49:08.000000000 +0900", csa_seq: [["+7968GI", 600], ["-8232HI", 600], ["+5756FU", 600], ["-3334FU", 600], ["+6857GI", 600]], win_user_id: 966884, turn_max: 5, meta_info: {}, created_at: "2024-07-05 23:49:09.000000000 +0900", updated_at: "2024-07-05 23:49:09.000000000 +0900", start_turn: nil, critical_turn: nil, sfen_body: "position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPP...", image_turn: nil, outbreak_turn: nil, accessed_at: "2024-07-05 23:49:08.000000000 +0900", sfen_hash: "7b7e2206a9d4cdf21d06bc390228ced8", xmode_id: 1, preset_id: 1, rule_id: 1, final_id: 1, defense_tag_list: nil, attack_tag_list: nil, technique_tag_list: nil, note_tag_list: nil>
# exit
# tp Swars::Battle.limit(nil).user_only("SiroChannel")
# exit

# sql
Swars::Battle.limit(nil).old_only(50.days).count          # => 
Swars::Battle.limit(nil).pro_only.count                   # => 
Swars::Battle.limit(nil).pro_except.count                 # => 
Swars::Battle.limit(nil).ban_only.count                   # => 
Swars::Battle.limit(nil).ban_except.count                 # => 
Swars::Battle.limit(nil).user_only("SiroChannel").count   # => 
Swars::Battle.limit(nil).user_except("SiroChannel").count # => 
Swars::Battle.limit(nil).xmode_only("指導").count         # => 
Swars::Battle.limit(nil).xmode_except("指導").count       # => 
Swars::Battle.limit(nil).coaching_only.count              # => 
Swars::Battle.limit(nil).coaching_except.count            # => 

Swars::Battle.scope_for_cleaner1.count                    # => 
Swars::Battle.scope_for_cleaner2.count                    # => 
# >> |---------+------------------------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------+-----------+---------------------------+---------------------------+------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------------+---------------------------+----------------------------------+----------+-----------+---------+----------+------------------+-----------------+--------------------+---------------|
# >> | id      | key                                      | battled_at                | csa_seq                                                                                                                                                                                                                                                             | win_user_id | turn_max | meta_info | created_at                | updated_at                | start_turn | critical_turn | sfen_body                                                                                                                                                                                                                                                           | image_turn | outbreak_turn | accessed_at               | sfen_hash                        | xmode_id | preset_id | rule_id | final_id | defense_tag_list | attack_tag_list | technique_tag_list | note_tag_list |
# >> |---------+------------------------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------+-----------+---------------------------+---------------------------+------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------------+---------------------------+----------------------------------+----------+-----------+---------+----------+------------------+-----------------+--------------------+---------------|
# >> | 4502003 | Manaochannel-SiroChannel-20200910_174930 | 2020-09-10 17:49:30 +0900 | [["+2726FU", 587], ["-3334FU", 597], ["+7776FU", 584], ["-4344FU", 592], ["+2625FU", 580], ["-3132GI", 587], ["+3948GI", 570], ["-3233GI", 582], ["+5968OU", 565], ["-8242HI", 534], ["+6878OU", 533], ["-4132KI", 532], ["+5756FU", 529], ["-7172GI", 527], ["+... |       23502 |       42 | {}        | 2020-09-10 17:57:23 +0900 | 2022-12-12 12:48:56 +0900 |            |            32 | position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1 moves 2g2f 3c3d 7g7f 4c4d 2f2e 3a3b 3i4h 3b3c 5i6h 8b4b 6h7h 4a3b 5g5f 7a7b 4i5h 5a6b 3g3f 6b7a 9g9f 4d4e 4h5g 7a8b 7i6h 7c7d 9f9e 3b4c 1g1f 5c5d 4g4f 3c4d 2e2d 4c3c 2d2c+ 2b3a 2... |            |            34 | 2024-03-05 16:31:17 +0900 | cb10f3c4649c96b6a5406a5caedf1d7e |        3 |         1 |       1 |        1 |                  |                 |                    |               |
# >> | 4503319 | SiroChannel-alice_oxo927-20200910_182532 | 2020-09-10 18:25:32 +0900 | [["+7776FU", 597], ["-8252HI", 592], ["+6766FU", 593], ["-3334FU", 591], ["+2858HI", 575], ["-5354FU", 586], ["+3938GI", 574], ["-5162OU", 579], ["+5948OU", 572], ["-6272OU", 577], ["+4839OU", 571], ["-7282OU", 576], ["+3928OU", 565], ["-7172GI", 575], ["+... |      316257 |       96 | {}        | 2020-09-10 18:55:37 +0900 | 2022-02-07 15:22:07 +0900 |            |            23 | position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1 moves 7g7f 8b5b 6g6f 3c3d 2h5h 5c5d 3i3h 5a6b 5i4h 6b7b 4h3i 7b8b 3i2h 7a7b 6i5i 3a3b 5i4h 4c4d 4g4f 3b4c 4h4g 5d5e 5g5f 5e5f 4g5f 3d3e P*5e 4c3d 3h4g 6c6d 8h7g 9c9d 5h3h 7c7d 7i... |            |            53 | 2023-11-26 18:08:41 +0900 | a0bc724446793b184c1106af0b198369 |        3 |         1 |       1 |        2 |                  |                 |                    |               |
# >> | 4503320 | SiroChannel-Manaochannel-20200910_175711 | 2020-09-10 17:57:11 +0900 | [["+7776FU", 582], ["-8384FU", 599], ["+6766FU", 580], ["-8485FU", 596], ["+8877KA", 576], ["-3334FU", 594], ["+6968KI", 572], ["-7162GI", 589], ["+6869KI", 536], ["-6271GI", 588], ["+2868HI", 516], ["-7162GI", 586], ["+7978GI", 513], ["-5142OU", 584], ["+... |       23502 |       65 | {}        | 2020-09-10 18:55:38 +0900 | 2022-12-12 12:48:57 +0900 |            |            31 | position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1 moves 7g7f 8c8d 6g6f 8d8e 8h7g 3c3d 6i6h 7a6b 6h6i 6b7a 2h6h 7a6b 7i7h 5a4b 3i3h 4b3b 5i4h 5c5d 4h3i 6a5b 6i5h 1c1d 1g1f 3a4b 4g4f 7c7d 5h4g 6b7c 3g3f 7c8d 6f6e 2b7g+ 7h7g 4b5c 9... |            |            44 | 2023-10-08 23:23:35 +0900 | 7b80f1634bf0fbb1c734b8854291303a |        3 |         1 |       1 |        3 |                  |                 |                    |               |
# >> | 4913021 | Kato_Hifumi-SiroChannel-20200927_180900  | 2020-09-27 18:09:00 +0900 | [["+7776FU", 575], ["-3334FU", 597], ["+2726FU", 571], ["-8242HI", 593], ["+2625FU", 568], ["-5162OU", 589], ["+3948GI", 562], ["-6272OU", 585], ["+5968OU", 560], ["-2288UM", 580], ["+7988GI", 556], ["-3122GI", 576], ["+8877GI", 552], ["-2233GI", 572], ["+... |       23502 |      116 | {}        | 2020-09-27 19:01:04 +0900 | 2020-09-27 19:01:04 +0900 |            |             9 | position startpos moves 7g7f 3c3d 2g2f 8b4b 2f2e 5a6b 3i4h 6b7b 5i6h 2b8h+ 7i8h 3a2b 8h7g 2b3c 6h7h 9c9d 9g9f 4c4d 3g3f 4d4e 4h3g 4a3b 4i5h 3c4d 2e2d 2c2d 2h2d P*2c 2d2f 4d5e 6i6h 6a5a 1g1f 5e4d 1f1e 7a6b 7g6f 4b4a 5g5f 2a3c 2f2h 5c5d 8i7g 4a2a P*2e 2a4a 2... |            |            60 | 2024-06-01 16:29:27 +0900 | 38aac9e76b2d13fbb5c85c3cec47dcf8 |        3 |         1 |       1 |        2 |                  |                 |                    |               |
# >> |---------+------------------------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------+-----------+---------------------------+---------------------------+------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------------+---------------------------+----------------------------------+----------+-----------+---------+----------+------------------+-----------------+--------------------+---------------|
