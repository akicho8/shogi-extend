require "../setup"
tp Swars::User["SugarHuuko"].user_stat.medal_stat.to_debug_hash
_ { Swars::User["SugarHuuko"].user_stat.medal_stat.to_a } # => "70.62 ms"
s { Swars::User["SugarHuuko"].user_stat.medal_stat.to_a } # => [{:message=>"居飛車党", :method=>"raw", :name=>"⬆️", :type=>nil}, {:message=>"右玉で勝った", :method=>"raw", :name=>"🌛", :type=>nil}, {:message=>"UFO銀で勝った", :method=>"raw", :name=>"🛸", :type=>nil}, {:message=>"大駒全部捨てて勝った", :method=>"raw", :name=>"🧠", :type=>nil}, {:message=>"10連勝した", :method=>"raw", :name=>"💮", :type=>nil}, {:message=>"対局放棄と受け取られかねない長考をした", :method=>"raw", :name=>"🚫", :type=>nil}, {:message=>"開幕千日手をした", :method=>"raw", :name=>"❓", :type=>nil}, {:message=>"千日手があった", :method=>"raw", :name=>"🍌", :type=>nil}]
# >> |---------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
# >> |                  対象サンプル数 | 50                                                                                                                                                                                                                                                                                                                                                                           |
# >> |                          勝ち数 | 39                                                                                                                                                                                                                                                                                                                                                                           |
# >> |                          負け数 | 8                                                                                                                                                                                                                                                                                                                                                                            |
# >> |                            勝率 | 0.78                                                                                                                                                                                                                                                                                                                                                                         |
# >> |                      引き分け率 | 0.02                                                                                                                                                                                                                                                                                                                                                                         |
# >> |         切れ負け率(分母:負け数) | 0.125                                                                                                                                                                                                                                                                                                                                                                        |
# >> |             切断率(分母:負け数) | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                        居飛車率 | 1.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                      振り飛車率 | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                        居玉勝率 | 0.18                                                                                                                                                                                                                                                                                                                                                                         |
# >> |                    アヒル囲い率 | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                        嬉野流率 | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                            棋風 | {:rarity_key_SSR=>0.14, :rarity_key_SR=>0.28, :rarity_key_R=>0.16, :rarity_key_N=>0.42}                                                                                                                                                                                                                                                                                      |
# >> | 1手詰を詰まさないでじらした割合 | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |                絶対投了しない率 | 0.0                                                                                                                                                                                                                                                                                                                                                                          |
# >> |              大長考または放置率 | 0.02                                                                                                                                                                                                                                                                                                                                                                         |
# >> |              棋神降臨疑惑対局数 | 0                                                                                                                                                                                                                                                                                                                                                                            |
# >> |                長考または放置率 | 0.02                                                                                                                                                                                                                                                                                                                                                                         |
# >> |                    最大連勝連敗 | {:lose=>2, :win=>12, :draw=>1}                                                                                                                                                                                                                                                                                                                                               |
# >> |                      タグの重み | {:力戦=>17, :居飛車=>50, :カブト囲い=>1, :箱入り娘=>1, :銀雲雀=>1, :舟囲い=>9, :居飛車金美濃=>2, :対振り持久戦=>1, :新型雁木=>6, :相掛かり=>1, :▲４五歩早仕掛け=>2, :居玉=>11, :△３三角型空中戦法=>1, :ツノ銀雁木=>1, :オールド雁木=>1, :原始棒銀=>5, :UFO銀=>5, :へこみ矢倉=>1, :串カツ囲い=>1, :金盾囲い=>1, :角交換型=>3, :角換わり=>1, :右玉=>3, :手得角交換型=>1, ... |
# >> |---------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
# >>   Swars::User Load (0.2ms)  SELECT `swars_users`.* FROM `swars_users` WHERE `swars_users`.`user_key` = 'SugarHuuko' LIMIT 1
# >>   ↳ app/models/swars/user.rb:5:in `[]'
# >>   Swars::Membership Ids (21.5ms)  SELECT `swars_memberships`.`id` FROM `swars_memberships` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`user_id` = 17413 ORDER BY `swars_battles`.`battled_at` DESC LIMIT 50
# >>   ↳ app/models/swars/user_stat/base_scope_methods.rb:35:in `scope_ids'
# >>   Swars::Membership Count (0.4ms)  SELECT COUNT(*) FROM `swars_memberships` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490)
# >>   ↳ app/models/swars/user_stat/base_scope_methods.rb:45:in `ids_count'
# >>   Swars::Membership Pluck (0.6ms)  SELECT `swars_memberships`.`id` FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win'
# >>   ↳ app/models/swars/user_stat/tag_stat.rb:63:in `block in to_h'
# >>   ActsAsTaggableOn::Tag Load (1.5ms)  SELECT tags.*, taggings.tags_count AS count FROM `tags` JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM `taggings` WHERE (taggings.taggable_type = 'Swars::Membership') AND (taggings.taggable_id IN ('97904485','97904490','97904863','97909143','97909144','98191817','98196869','98196872','98196874','98196876','98196878','98196881','98196899','98196901','98196903','98196909','98196911','98196913','98196915','98208928','98212769','98212771','98212774','98212775','98212778','98263994','98263995','98263998','98264000','98264001','98264003','98264007','98271896','98271900','98271905','98271907','98271911','98271913','98303204')) GROUP BY `taggings`.`tag_id` HAVING (COUNT(taggings.tag_id) > 0)) AS taggings ON taggings.tag_id = tags.id
# >>   ↳ app/models/swars/user_stat/tag_stat.rb:64:in `each_with_object'
# >>   Swars::Membership Pluck (0.4ms)  SELECT `swars_memberships`.`id` FROM `swars_memberships` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490)
# >>   ↳ app/models/swars/user_stat/tag_stat.rb:63:in `block in to_h'
# >>   ActsAsTaggableOn::Tag Load (1.6ms)  SELECT tags.*, taggings.tags_count AS count FROM `tags` JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM `taggings` WHERE (taggings.taggable_type = 'Swars::Membership') AND (taggings.taggable_id IN ('97904485','97904487','97904490','97904863','97909143','97909144','98191817','98196869','98196871','98196872','98196874','98196876','98196878','98196881','98196885','98196899','98196901','98196903','98196909','98196911','98196913','98196915','98208928','98212763','98212766','98212768','98212769','98212771','98212774','98212775','98212778','98263994','98263995','98263998','98264000','98264001','98264003','98264005','98264007','98271894','98271896','98271899','98271900','98271902','98271905','98271907','98271909','98271911','98271913','98303204')) GROUP BY `taggings`.`tag_id` HAVING (COUNT(taggings.tag_id) > 0)) AS taggings ON taggings.tag_id = tags.id
# >>   ↳ app/models/swars/user_stat/tag_stat.rb:64:in `each_with_object'
# >>   Swars::Membership Pluck (0.4ms)  SELECT `judges`.`key` FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) ORDER BY FIELD(swars_memberships.id, '98271894','98271896','98271899','98271900','98271902','98271905','98271907','98271909','98271911','98271913','98303204','98212763','98212766','98212768','98212769','98212771','98212774','98208928','98212775','98212778','98263994','98263995','98263998','98264000','98264001','98264003','98264005','98264007','98196869','98196871','98196872','98196874','98196876','98196878','98196881','98196885','98196899','98196901','98196903','98196909','98196911','98196913','98196915','98191817','97909143','97909144','97904863','97904485','97904487','97904490')
# >>   ↳ app/models/application_record.rb:69:in `block in custom_belongs_to'
# >>   Swars::Membership Count (0.5ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win'
# >>   ↳ app/models/swars/user_stat/sub_scope_methods.rb:25:in `w_count'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win' AND `swars_battles`.`turn_max` = 100
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:333:in `block in one_hundred_win_rate'
# >>   Swars::Membership Count (1.1ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` INNER JOIN `taggings` `swars::membe_taggings_10261ad` ON `swars::membe_taggings_10261ad`.`taggable_id` = `swars_memberships`.`id` AND `swars::membe_taggings_10261ad`.`taggable_type` = 'Swars::Membership' AND `swars::membe_taggings_10261ad`.`tag_id` IN (SELECT `tags`.`id` FROM `tags` WHERE LOWER(`tags`.`name`) LIKE '居玉' ESCAPE '!') AND `swars::membe_taggings_10261ad`.`context` = 'defense_tags' WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win' AND (`swars_finals`.`key` = 'TORYO' OR `swars_finals`.`key` = 'TIMEOUT' OR `swars_finals`.`key` = 'CHECKMATE') AND `swars_battles`.`turn_max` >= 50
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:151:in `igyoku_win_ratio'
# >>   Swars::Membership Count (0.5ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose'
# >>   ↳ app/models/swars/user_stat/sub_scope_methods.rb:35:in `l_count'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_finals`.`key` = 'TIMEOUT' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:304:in `block in lose_ratio_of'
# >>   Swars::Membership Pluck (0.4ms)  SELECT `swars_memberships`.`id` FROM `swars_memberships` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490)
# >>   ↳ app/models/swars/user_stat/rarity_stat.rb:73:in `block in tags'
# >>   ActsAsTaggableOn::Tag Load (1.3ms)  SELECT tags.*, taggings.tags_count AS count FROM `tags` JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM `taggings` WHERE (taggings.taggable_type = 'Swars::Membership' AND taggings.context = 'attack_tags') AND (taggings.taggable_id IN ('97904485','97904487','97904490','97904863','97909143','97909144','98191817','98196869','98196871','98196872','98196874','98196876','98196878','98196881','98196885','98196899','98196901','98196903','98196909','98196911','98196913','98196915','98208928','98212763','98212766','98212768','98212769','98212771','98212774','98212775','98212778','98263994','98263995','98263998','98264000','98264001','98264003','98264005','98264007','98271894','98271896','98271899','98271900','98271902','98271905','98271907','98271909','98271911','98271913','98303204')) GROUP BY `taggings`.`tag_id` HAVING (COUNT(taggings.tag_id) > 0)) AS taggings ON taggings.tag_id = tags.id
# >>   ↳ app/models/swars/user_stat/rarity_stat.rb:72:in `each'
# >>   Swars::Membership Pluck (0.4ms)  SELECT `swars_memberships`.`id` FROM `swars_memberships` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490)
# >>   ↳ app/models/swars/user_stat/rarity_stat.rb:73:in `block in tags'
# >>   ActsAsTaggableOn::Tag Load (1.3ms)  SELECT tags.*, taggings.tags_count AS count FROM `tags` JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM `taggings` WHERE (taggings.taggable_type = 'Swars::Membership' AND taggings.context = 'defense_tags') AND (taggings.taggable_id IN ('97904485','97904487','97904490','97904863','97909143','97909144','98191817','98196869','98196871','98196872','98196874','98196876','98196878','98196881','98196885','98196899','98196901','98196903','98196909','98196911','98196913','98196915','98208928','98212763','98212766','98212768','98212769','98212771','98212774','98212775','98212778','98263994','98263995','98263998','98264000','98264001','98264003','98264005','98264007','98271894','98271896','98271899','98271900','98271902','98271905','98271907','98271909','98271911','98271913','98303204')) GROUP BY `taggings`.`tag_id` HAVING (COUNT(taggings.tag_id) > 0)) AS taggings ON taggings.tag_id = tags.id
# >>   ↳ app/models/swars/user_stat/rarity_stat.rb:72:in `each'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_finals`.`key` = 'DISCONNECT' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:304:in `block in lose_ratio_of'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win' AND `swars_memberships`.`think_last` >= 60 AND `swars_rules`.`key` = 'ten_min' AND `swars_finals`.`key` = 'CHECKMATE'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:171:in `teasing_count_for'
# >>   Swars::Membership Count (1.3ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'win' AND `swars_memberships`.`think_last` >= 45 AND `swars_rules`.`key` = 'three_min' AND `swars_finals`.`key` = 'CHECKMATE'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:171:in `teasing_count_for'
# >>   Swars::Membership Count (0.9ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_last` >= 180 AND `swars_rules`.`key` = 'ten_min' AND `swars_finals`.`key` = 'TIMEOUT' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:192:in `zettai_toryo_sinai_count_for'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_last` >= 60 AND `swars_rules`.`key` = 'three_min' AND `swars_finals`.`key` = 'TIMEOUT' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:192:in `zettai_toryo_sinai_count_for'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_last` IS NOT NULL AND `swars_memberships`.`think_max` != `swars_memberships`.`think_last` AND `swars_memberships`.`think_max` >= 300 AND `swars_rules`.`key` = 'ten_min' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:214:in `taisekimachi_count_for'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_last` IS NOT NULL AND `swars_memberships`.`think_max` != `swars_memberships`.`think_last` AND `swars_memberships`.`think_max` >= 120 AND `swars_rules`.`key` = 'three_min' AND `swars_battles`.`turn_max` >= 14
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:214:in `taisekimachi_count_for'
# >>   Swars::Membership Count (0.4ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `swars_memberships`.`think_max` >= 180 AND `swars_rules`.`key` = 'ten_min'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:234:in `long_think_count_for'
# >>   Swars::Membership Count (0.4ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `swars_memberships`.`think_max` >= 60 AND `swars_rules`.`key` = 'three_min'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:234:in `long_think_count_for'
# >>   Swars::Membership Count (0.7ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_max` >= 150 AND `swars_memberships`.`think_max` < 180 AND `swars_rules`.`key` = 'ten_min'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:254:in `short_think_count_for'
# >>   Swars::Membership Count (0.7ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_rules` ON `swars_rules`.`id` = `swars_battles`.`rule_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND `swars_memberships`.`think_max` >= 30 AND `swars_memberships`.`think_max` < 60 AND `swars_rules`.`key` = 'three_min'
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:254:in `short_think_count_for'
# >>   Swars::Membership Count (0.8ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` INNER JOIN `swars_finals` ON `swars_finals`.`id` = `swars_battles`.`final_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'lose' AND (`swars_finals`.`key` = 'TORYO' OR `swars_finals`.`key` = 'CHECKMATE') AND `swars_battles`.`turn_max` <= 19
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:318:in `block in hayai_toryo'
# >>   Swars::Membership Count (0.7ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'draw' AND `swars_battles`.`turn_max` = 12
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:268:in `block in start_draw_ratio'
# >>   Swars::Membership Count (0.7ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `judges` ON `judges`.`id` = `swars_memberships`.`judge_id` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND `judges`.`key` = 'draw' AND `swars_battles`.`turn_max` >= 50
# >>   ↳ app/models/swars/user_stat/medal_stat.rb:282:in `block in draw_ratio'
# >>   Swars::Xmode Load (0.2ms)  SELECT `swars_xmodes`.* FROM `swars_xmodes` ORDER BY `swars_xmodes`.`position` ASC
# >>   ↳ app/models/swars/user_stat/xmode_stat.rb:32:in `each_with_object'
# >>   Swars::Membership Count (0.4ms)  SELECT COUNT(*) AS `count_all`, `swars_battles`.`xmode_id` AS `swars_battles_xmode_id` FROM `swars_memberships` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) GROUP BY `swars_battles`.`xmode_id`
# >>   ↳ app/models/swars/user_stat/xmode_stat.rb:27:in `attributes'
# >>   Swars::Membership Count (0.3ms)  SELECT COUNT(*) FROM `swars_memberships` INNER JOIN `swars_battles` ON `swars_battles`.`id` = `swars_memberships`.`battle_id` WHERE `swars_memberships`.`id` IN (98271894, 98271896, 98271899, 98271900, 98271902, 98271905, 98271907, 98271909, 98271911, 98271913, 98303204, 98212763, 98212766, 98212768, 98212769, 98212771, 98212774, 98208928, 98212775, 98212778, 98263994, 98263995, 98263998, 98264000, 98264001, 98264003, 98264005, 98264007, 98196869, 98196871, 98196872, 98196874, 98196876, 98196878, 98196881, 98196885, 98196899, 98196901, 98196903, 98196909, 98196911, 98196913, 98196915, 98191817, 97909143, 97909144, 97904863, 97904485, 97904487, 97904490) AND (`swars_memberships`.`ai_wave_count` >= 3 OR `swars_memberships`.`ai_drop_total` >= 15 OR `swars_memberships`.`ai_two_freq` >= 0.6 AND `swars_battles`.`turn_max` >= 50)
# >>   ↳ app/models/swars/user_stat/fraud_stat.rb:13:in `count'
