#!/usr/bin/env ruby
require File.expand_path('../../config/environment', __FILE__)

# KifuExtractor.extract("http://example.com/#68S")  # => "68S"
# KifuExtractor.extract("http://example.com/#76%E6%AD%A9") # => "76歩"
# KifuExtractor.extract("http://example.com/?body=76%E6%AD%A9") # => "76歩"
# KifuExtractor.extract("https://www.shogi-extend.com/share-board?body=position.sfen.4k4%2F9%2F4p4%2F9%2F9%2F9%2F4P4%2F9%2F4K4.b.P.1.moves.5g5f.5c5d.P%2a5e&turn=3&viewpoint=black&color_theme_key=is_color_theme_real") # => "position sfen 4k4/9/4p4/9/9/9/4P4/9/4K4 b P 1 moves 5g5f 5c5d P*5e"
# KifuExtractor.extract("https://shogidb2.com/games/0e0f7f6518bca14e5b784015963d5f38795c86a7") # => "開始日時：2021-12-18T05:00:00.000Z\n終了日時：2021-12-18T06:48:00.000Z\n棋戦詳細：第15回朝日杯将棋オープン戦二次予選\n棋戦：朝日杯将棋オープン戦\n手合割：平手\n戦型：横歩取り\n後手：飯島栄治 八段\n場所：東京都渋谷区「シャトーアメーバ」\n先手：丸山忠久 九段\n\n２六歩(27) ３四歩(33) ７六歩(77) ８四歩(83) ２五歩(26) ８五歩(84) ７八金(69) ３二金(41) ２四歩(25) 同歩(23) 同飛(28) ８六歩(85) 同歩(87) 同飛(82) ３四飛(24) ３三角(22) ５八玉(59) ８二飛(86) ３六歩(37) ２六歩打 ２八歩打 ２二銀(31) ３七桂(29) ４二玉(51) ８七歩打 ６二銀(71) ３八銀(39) ５一金(61) ３五飛(34) ２七歩成(26) 同歩(28) ７四歩(73) ９六歩(97) ６四歩(63) ７七桂(89) ７三桂(81) ７五歩(76) ８四飛(82) ８六歩(87) ２三銀(22) ４五桂(37) ４四角(33) ８五歩(86) 同桂(73) 同桂(77) ８八角成(44) 同銀(79) ３四歩打 ２五飛(35) ２四歩打 ５三桂成(45) 同銀(62) ５五飛(25) ８五飛(84) ７三角打 ５二金(51) ９一角成(73) ５四桂打 ４五桂打 ２八角打 ５六飛(55) ７五飛(85) ５三桂成(45) 同金(52) ７七香打 ５五飛(75) ７三馬(91) ３三玉(42) ６二馬(73) ４四金(53) ５一馬(62) ２二玉(33) ４一馬(51) ５六飛(55) 同歩(57) ６六桂打 同歩(67) 同桂(54) ４八玉(58) ７八桂成(66) １五桂打 ６八飛打 ５八金(49) 同飛成(68) 同玉(48) ６八金打 投了\n"
# KifuExtractor.extract("https://shogidb2.com/board?sfen=lnsgkgsnl%2F1r5b1%2Fppppppppp%2F9%2F9%2F2P6%2FPP1PPPPPP%2F1B5R1%2FLNSGKGSNL%20w%20-%202&moves=-3334FU%2B2726FU-8384FU%2B2625FU-8485FU%2B5958OU-4132KI%2B6978KI-8586FU%2B8786FU-8286HI%2B2524FU-2324FU%2B2824HI-8684HI%2B0087FU-0023FU%2B2428HI-2233KA%2B5868OU-7172GI%2B9796FU-3142GI%2B8833UM") # => "position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/2P6/PP1PPPPPP/1B5R1/LNSGKGSNL w - 2"
# KifuExtractor.extract("https://www.shogi-extend.com/swars/battles/Kato_Hifumi-SiroChannel-20200927_180900/?viewpoint=white&turn=9") == "N+Kato_Hifumi 三段\nN-SiroChannel 四段\n$START_TIME:2020/09/27 18:09:00\n$EVENT:将棋ウォーズ(10分切れ負け)\n$TIME_LIMIT:00:10+00\n+\n+5756FU\nT0\n-8384FU\nT1\n+7776FU\nT2\n-8485FU\nT1\n+8877KA\nT1\n-6152KI\nT1\n+2858HI\nT2\n-7162GI\nT9\n+7968GI\nT1\n-5142OU\nT0\n+6857GI\nT1\n-4232OU\nT2\n+5948OU\nT1\n-1314FU\nT7\n+1716FU\nT1\n-6364FU\nT1\n+5655FU\nT1\n-6263GI\nT3\n+5756GI\nT1\n-3142GI\nT1\n+4838OU\nT1\n-4344FU\nT2\n+3828OU\nT1\n-4243GI\nT1\n+3938GI\nT2\n-7374FU\nT0\n+9796FU\nT2\n-9394FU\nT2\n+9997KY\nT1\n-3334FU\nT7\n+4746FU\nT2\n-2233KA\nT5\n+5898HI\nT2\n-8586FU\nT7\n+8786FU\nT2\n-8284HI\nT2\n+..." }

# KifuExtractor.extract("https://lishogi.org/ZY2Tyy2dUdLl")   # => "開始日時：2021/12/06 04:37:40\n終了日時：2021/12/21 04:11:52\n棋戦：Rated Correspondence game\n場所：https://lishogi.org/ZY2Tyy2d\n手合割：平手\n先手：dopamine57\n後手：Megeton\n手数----指手---------消費時間--\n   1   ２六歩(27)\n   2   ３四歩(33)\n   3   ２五歩(26)\n   4   ３三角(22)\n   5   ７六歩(77)\n   6   ３二銀(31)\n   7   ３三角成(88)\n   8   同　銀(32)\n   9   ８八銀(79)\n  10   ３二金(41)\n  11   ７七銀(88)\n  12   ６二銀(71)\n  13   ７八金(69)\n  14   ６四歩(63)\n  15   ３八銀(39)\n  16   ６三銀(62)\n  17   ６八玉(59)\n  18   ８四歩(83)\n  19   ２七銀(38)\n  20   ５二金(61)\n  21   ２六銀(27)\n  22   ７四歩(73)\n  23   １五銀(26)\n  24   ５四角打\n  25   ３六角打\n  26   同　角(54)\n  27   同　歩(37)\n  28   ５五角打\n  29   ３七角打\n  30   同　角成(55)\n  31   同　桂(29)\n  32   ５五角打\n  33   ３八金(49)\n  34   ２二銀(33)\n  35   ５六歩(57)\n  36   ４四角(55)\n  37   ４六歩(47)\n  38   ７三桂(81)\n  39   ６六歩(67)\n  40   ５四歩(53)\n  41   ４五歩(46)\n  42   ５三角(44)\n  43   ４七金(38)\n  44   ８一飛(82)\n  45   ４六角打\n  46   ６二玉(51)\n  47   １六歩(17)\n  48   １四歩(13)\n  49   ２六銀(15)\n  50   ３三銀(22)\n  51   ３五歩(36)\n  52   同　歩(34)\n  53   同　銀(26)\n  54   ２二銀(33)\n  55   ２四歩(25)\n  56   同　歩(23)\n  57   同　銀(35)\n  58   ２三歩打\n  59   ３五銀(24)\n  60   ３三銀(22)\n  61   ２四歩打\n  62   同　歩(23)\n  63   同　銀(35)\n  64   ２七歩打\n  65   ５八飛(28)\n  66   ３六歩打\n  67   ２五桂(37)\n  68   ２四銀(33)\n  69   同　角(46)\n  70   ４二金(32)\n  71   ３四歩打\n  72   ３五銀打\n  73   ４二角成(24)\n  74   同　金(52)\n  75   ７五歩(76)\n  76   同　歩(74)\n  77   ５五歩(56)\n  78   同　歩(54)\n  79   ３三歩成(34)\n  80   同　桂(21)\n  81   同　桂成(25)\n  82   同　金(42)\n  83   ７四歩打\n  84   ３七歩成(36)\n  85   ７三歩成(74)\n  86   同　玉(62)\n  87   ３七金(47)\n  88   ８五歩(84)\n  89   ５四歩打\n  90   同　銀(63)\n  91   ４七桂打\n  92   ８六歩(85)\n  93   同　歩(87)\n  94   ７六歩(75)\n  95   ７四歩打\n  96   ６二玉(73)\n  97   ７六銀(77)\n  98   ４九角打\n  99   ７三歩成(74)\n 100   ５二玉(62)\n 101   ２二銀打\n 102   ３二金(33)\n 103   ３三金打\n 104   ２二金(32)\n 105   同　金(33)\n 106   ５六桂打\n 107   ６九玉(68)\n 108   ５八角成(49)"
# KifuExtractor.extract("https://lishogi.org/ZY2Tyy2d/sente") # => "開始日時：2021/12/06 04:37:40\n終了日時：2021/12/21 04:11:52\n棋戦：Rated Correspondence game\n場所：https://lishogi.org/ZY2Tyy2d\n手合割：平手\n先手：dopamine57\n後手：Megeton\n手数----指手---------消費時間--\n   1   ２六歩(27)\n   2   ３四歩(33)\n   3   ２五歩(26)\n   4   ３三角(22)\n   5   ７六歩(77)\n   6   ３二銀(31)\n   7   ３三角成(88)\n   8   同　銀(32)\n   9   ８八銀(79)\n  10   ３二金(41)\n  11   ７七銀(88)\n  12   ６二銀(71)\n  13   ７八金(69)\n  14   ６四歩(63)\n  15   ３八銀(39)\n  16   ６三銀(62)\n  17   ６八玉(59)\n  18   ８四歩(83)\n  19   ２七銀(38)\n  20   ５二金(61)\n  21   ２六銀(27)\n  22   ７四歩(73)\n  23   １五銀(26)\n  24   ５四角打\n  25   ３六角打\n  26   同　角(54)\n  27   同　歩(37)\n  28   ５五角打\n  29   ３七角打\n  30   同　角成(55)\n  31   同　桂(29)\n  32   ５五角打\n  33   ３八金(49)\n  34   ２二銀(33)\n  35   ５六歩(57)\n  36   ４四角(55)\n  37   ４六歩(47)\n  38   ７三桂(81)\n  39   ６六歩(67)\n  40   ５四歩(53)\n  41   ４五歩(46)\n  42   ５三角(44)\n  43   ４七金(38)\n  44   ８一飛(82)\n  45   ４六角打\n  46   ６二玉(51)\n  47   １六歩(17)\n  48   １四歩(13)\n  49   ２六銀(15)\n  50   ３三銀(22)\n  51   ３五歩(36)\n  52   同　歩(34)\n  53   同　銀(26)\n  54   ２二銀(33)\n  55   ２四歩(25)\n  56   同　歩(23)\n  57   同　銀(35)\n  58   ２三歩打\n  59   ３五銀(24)\n  60   ３三銀(22)\n  61   ２四歩打\n  62   同　歩(23)\n  63   同　銀(35)\n  64   ２七歩打\n  65   ５八飛(28)\n  66   ３六歩打\n  67   ２五桂(37)\n  68   ２四銀(33)\n  69   同　角(46)\n  70   ４二金(32)\n  71   ３四歩打\n  72   ３五銀打\n  73   ４二角成(24)\n  74   同　金(52)\n  75   ７五歩(76)\n  76   同　歩(74)\n  77   ５五歩(56)\n  78   同　歩(54)\n  79   ３三歩成(34)\n  80   同　桂(21)\n  81   同　桂成(25)\n  82   同　金(42)\n  83   ７四歩打\n  84   ３七歩成(36)\n  85   ７三歩成(74)\n  86   同　玉(62)\n  87   ３七金(47)\n  88   ８五歩(84)\n  89   ５四歩打\n  90   同　銀(63)\n  91   ４七桂打\n  92   ８六歩(85)\n  93   同　歩(87)\n  94   ７六歩(75)\n  95   ７四歩打\n  96   ６二玉(73)\n  97   ７六銀(77)\n  98   ４九角打\n  99   ７三歩成(74)\n 100   ５二玉(62)\n 101   ２二銀打\n 102   ３二金(33)\n 103   ３三金打\n 104   ２二金(32)\n 105   同　金(33)\n 106   ５六桂打\n 107   ６九玉(68)\n 108   ５八角成(49)"
# KifuExtractor.extract("https://lishogi.org/ZY2Tyy2d/gote")  # => "開始日時：2021/12/06 04:37:40\n終了日時：2021/12/21 04:11:52\n棋戦：Rated Correspondence game\n場所：https://lishogi.org/ZY2Tyy2d\n手合割：平手\n先手：dopamine57\n後手：Megeton\n手数----指手---------消費時間--\n   1   ２六歩(27)\n   2   ３四歩(33)\n   3   ２五歩(26)\n   4   ３三角(22)\n   5   ７六歩(77)\n   6   ３二銀(31)\n   7   ３三角成(88)\n   8   同　銀(32)\n   9   ８八銀(79)\n  10   ３二金(41)\n  11   ７七銀(88)\n  12   ６二銀(71)\n  13   ７八金(69)\n  14   ６四歩(63)\n  15   ３八銀(39)\n  16   ６三銀(62)\n  17   ６八玉(59)\n  18   ８四歩(83)\n  19   ２七銀(38)\n  20   ５二金(61)\n  21   ２六銀(27)\n  22   ７四歩(73)\n  23   １五銀(26)\n  24   ５四角打\n  25   ３六角打\n  26   同　角(54)\n  27   同　歩(37)\n  28   ５五角打\n  29   ３七角打\n  30   同　角成(55)\n  31   同　桂(29)\n  32   ５五角打\n  33   ３八金(49)\n  34   ２二銀(33)\n  35   ５六歩(57)\n  36   ４四角(55)\n  37   ４六歩(47)\n  38   ７三桂(81)\n  39   ６六歩(67)\n  40   ５四歩(53)\n  41   ４五歩(46)\n  42   ５三角(44)\n  43   ４七金(38)\n  44   ８一飛(82)\n  45   ４六角打\n  46   ６二玉(51)\n  47   １六歩(17)\n  48   １四歩(13)\n  49   ２六銀(15)\n  50   ３三銀(22)\n  51   ３五歩(36)\n  52   同　歩(34)\n  53   同　銀(26)\n  54   ２二銀(33)\n  55   ２四歩(25)\n  56   同　歩(23)\n  57   同　銀(35)\n  58   ２三歩打\n  59   ３五銀(24)\n  60   ３三銀(22)\n  61   ２四歩打\n  62   同　歩(23)\n  63   同　銀(35)\n  64   ２七歩打\n  65   ５八飛(28)\n  66   ３六歩打\n  67   ２五桂(37)\n  68   ２四銀(33)\n  69   同　角(46)\n  70   ４二金(32)\n  71   ３四歩打\n  72   ３五銀打\n  73   ４二角成(24)\n  74   同　金(52)\n  75   ７五歩(76)\n  76   同　歩(74)\n  77   ５五歩(56)\n  78   同　歩(54)\n  79   ３三歩成(34)\n  80   同　桂(21)\n  81   同　桂成(25)\n  82   同　金(42)\n  83   ７四歩打\n  84   ３七歩成(36)\n  85   ７三歩成(74)\n  86   同　玉(62)\n  87   ３七金(47)\n  88   ８五歩(84)\n  89   ５四歩打\n  90   同　銀(63)\n  91   ４七桂打\n  92   ８六歩(85)\n  93   同　歩(87)\n  94   ７六歩(75)\n  95   ７四歩打\n  96   ６二玉(73)\n  97   ７六銀(77)\n  98   ４九角打\n  99   ７三歩成(74)\n 100   ５二玉(62)\n 101   ２二銀打\n 102   ３二金(33)\n 103   ３三金打\n 104   ２二金(32)\n 105   同　金(33)\n 106   ５六桂打\n 107   ６九玉(68)\n 108   ５八角成(49)"
# KifuExtractor.extract("https://lishogi.org/ZY2Tyy2d")       # => "開始日時：2021/12/06 04:37:40\n終了日時：2021/12/21 04:11:52\n棋戦：Rated Correspondence game\n場所：https://lishogi.org/ZY2Tyy2d\n手合割：平手\n先手：dopamine57\n後手：Megeton\n手数----指手---------消費時間--\n   1   ２六歩(27)\n   2   ３四歩(33)\n   3   ２五歩(26)\n   4   ３三角(22)\n   5   ７六歩(77)\n   6   ３二銀(31)\n   7   ３三角成(88)\n   8   同　銀(32)\n   9   ８八銀(79)\n  10   ３二金(41)\n  11   ７七銀(88)\n  12   ６二銀(71)\n  13   ７八金(69)\n  14   ６四歩(63)\n  15   ３八銀(39)\n  16   ６三銀(62)\n  17   ６八玉(59)\n  18   ８四歩(83)\n  19   ２七銀(38)\n  20   ５二金(61)\n  21   ２六銀(27)\n  22   ７四歩(73)\n  23   １五銀(26)\n  24   ５四角打\n  25   ３六角打\n  26   同　角(54)\n  27   同　歩(37)\n  28   ５五角打\n  29   ３七角打\n  30   同　角成(55)\n  31   同　桂(29)\n  32   ５五角打\n  33   ３八金(49)\n  34   ２二銀(33)\n  35   ５六歩(57)\n  36   ４四角(55)\n  37   ４六歩(47)\n  38   ７三桂(81)\n  39   ６六歩(67)\n  40   ５四歩(53)\n  41   ４五歩(46)\n  42   ５三角(44)\n  43   ４七金(38)\n  44   ８一飛(82)\n  45   ４六角打\n  46   ６二玉(51)\n  47   １六歩(17)\n  48   １四歩(13)\n  49   ２六銀(15)\n  50   ３三銀(22)\n  51   ３五歩(36)\n  52   同　歩(34)\n  53   同　銀(26)\n  54   ２二銀(33)\n  55   ２四歩(25)\n  56   同　歩(23)\n  57   同　銀(35)\n  58   ２三歩打\n  59   ３五銀(24)\n  60   ３三銀(22)\n  61   ２四歩打\n  62   同　歩(23)\n  63   同　銀(35)\n  64   ２七歩打\n  65   ５八飛(28)\n  66   ３六歩打\n  67   ２五桂(37)\n  68   ２四銀(33)\n  69   同　角(46)\n  70   ４二金(32)\n  71   ３四歩打\n  72   ３五銀打\n  73   ４二角成(24)\n  74   同　金(52)\n  75   ７五歩(76)\n  76   同　歩(74)\n  77   ５五歩(56)\n  78   同　歩(54)\n  79   ３三歩成(34)\n  80   同　桂(21)\n  81   同　桂成(25)\n  82   同　金(42)\n  83   ７四歩打\n  84   ３七歩成(36)\n  85   ７三歩成(74)\n  86   同　玉(62)\n  87   ３七金(47)\n  88   ８五歩(84)\n  89   ５四歩打\n  90   同　銀(63)\n  91   ４七桂打\n  92   ８六歩(85)\n  93   同　歩(87)\n  94   ７六歩(75)\n  95   ７四歩打\n  96   ６二玉(73)\n  97   ７六銀(77)\n  98   ４九角打\n  99   ７三歩成(74)\n 100   ５二玉(62)\n 101   ２二銀打\n 102   ３二金(33)\n 103   ３三金打\n 104   ２二金(32)\n 105   同　金(33)\n 106   ５六桂打\n 107   ６九玉(68)\n 108   ５八角成(49)"
# KifuExtractor.extract("76歩")   # => nil

# KifuExtractor.extract("https://lishogi.org/")
# puts FreeBattle.adapter_post(input_text: "https://lishogi.org/")

# puts KifuExtractor.extract("https://lishogi.org/ZY2Tyy2d/sente")
# puts KifuExtractor.extract("https://lishogi.org/ZY2Tyy2dUdLl")
# puts KifuExtractor.extract("https://lishogi.org/wbvpq4cR")
# puts KifuExtractor.extract("https://lishogi.org/")
# puts KifuExtractor.extract("http://live.shogi.or.jp/ryuou/kifu/33/ryuou202011260101.html")
# puts KifuExtractor.extract("https://www.shogi-extend.com/example_shift_jis.kif")

# KifuExtractor.extract("https://www.shogi-extend.com") # => "SHOGI-EXTEND\n  \n  \n    SHOGI-EXTENDログイン将棋ウォーズ棋譜検索他のアプリで検討したいときにどうぞぴよ将棋や KENTO で検討できるその他のソフトにはコピーして張り付け (CTRL+V)プレイヤー戦力分析機能付き符号の鬼符号マスター養成所100問正解するまでの時間を競う1分半切ったら卒業棋書を読むのが楽になるかもしれない動画作成NEW!棋譜を動画にしたいときにどうぞmp4, gif, png, zip 等に変換「なんでも棋譜変換」とかぶってるけどこっちは時間のかかる変換に特化している動画ライブラリNEW!動画作成のあとで登録するとここで見れるしょぼいので YouTube やニコニコ動画に上げた方がいいかもしれない共有将棋盤リレー将棋・詰将棋作成・仲間内での対戦にどうぞ秘密の部屋を立てて仲間内で対戦 (時計設置可)課題局面や詰将棋の作成・公開・共有SNS等にURLを貼って指し継ぐ通信将棋対人戦気軽に対局したいときにどうぞプレイ人数 2〜8人いまんところログイン不要これは共有将棋盤の「自動マッチング」へのショートカットなんでも棋譜変換棋譜が読み込めないときに放り込もう変則的な将棋倶楽部24の棋譜を正規化将棋クエストのCSA形式をKIFに変換KIF・KI2・SFEN・BOD 形式の相互変換将棋ドリル自分専用の問題集を作りたいときにどうぞ「問題」を作って「問題集」に入れるだけYoutubeと同じような公開設定機能あり詰将棋用ストップウォッチ正解率や速度を見える化したいときにどうぞ間違えた問題だけの復習が簡単途中からの再開が簡単問題は自分で用意してください将棋ウォーズ戦法分布人気戦法を知りたいときにどうぞ変動するように最近のだけ出してる囲いや段級位の分布もある人気戦法の対策をすれば勝ちやすいかも？将棋ウォーズイベント上位の成績上位プレイヤーの棋譜を見たいときにどうぞ現在開催中のイベントが対象名前タップで棋譜検索「─」は引き分け将棋ウォーズ十段の成績プロの棋譜を見たいときにどうぞ名前タップで棋譜検索先生方がほとんどだが野生の十段もいるなぜか電脳少女シロもいる奨励会三段リーグ成績早見表個人成績を見たいときにどうぞスマホに最適化個人毎の総成績表示在籍期間の表示CPU対戦ネット将棋で心をやられたときにどうぞ自作の将棋AI見掛け倒しな戦法を指す作者に似てめちゃくちゃ弱い対局時計大会などで時計が足りないときにどうぞ一般的なネット対局のプリセットを用意将棋倶楽部24の猶予時間に対応フィッシャールール対応将棋盤スタイルエディタ将棋盤のスタイルをいじくる開発用ツールもともとは将棋盤の動作テスト用に作ったものですが他の用途にも使えそうなので公開していますこれで加工した画面は自由に使ってもらってかまいません木目テクスチャ集NEW!!将棋盤用の木をどうぞサイズ: 1080x1080木目: 基本3パターン色相: 5パターンApps将棋ウォーズ棋譜検索符号の鬼動画作成動画ライブラリ共有将棋盤対人戦なんでも棋譜変換将棋ドリル詰将棋用ストップウォッチ将棋ウォーズ戦法分布将棋ウォーズイベント上位の成績将棋ウォーズ十段の成績奨励会三段リーグ成績早見表CPU対戦対局時計将棋盤スタイルエディタ木目テクスチャ集Experimentエモ将棋将棋トレーニングバトル実戦詰将棋『一期一会』目隠し詰将棋Aboutプライバシー利用規約クレジット問い合わせGitHubshogi-extendshogi-playerbioshogi将棋用語辞書shogi-mode.el"
# KifuExtractor.extract("https://lishogi.org")          # => "lishogi.org 窶「 Free Online Shogi\n\n\nlishogi.orgbetaPlaylishogi.org betaCreate a gameArena tournamentsSimultaneous exhibitionsPuzzlesPuzzlesPuzzle dashboardTsumeLearnShogi basicsShogi resourcesCoordinatesStudyWatchLishogi TVCurrent gamesStreamersVideo libraryCommunityPlayersBotsTeamsForumToolsAnalysis boardBoard editorImport gameAdvanced search\n\nSign inCreate a gamePlay with a friendPlay with the computer99 players37 games in play Lishogi is a free (really), libre, no-ads, open source shogi server. About Lishogi...sjeW2130?5|10gemmaro1652?Puzzle of the daySente to playLeaderboardMore »conconya238818pAshEl5227310conconya24715Beniiro218911pAshEl524606conconya238819pAshEl5233414NightCaster173510conconya231812Beniiro22773conconya25847Kiriya_Aoi238030BgM uenopanda191356boudantyokki171040Tournament winnersMore »SniperYearly BeniiroYearly SpAshEl5Yearly BeniiroYearly SHydoraigon41Yearly Rapidshort_intDaily Classicalshort_intWeekend SamatvWeekly Open tournamentsMore »Simultaneous exhibitionsMore »Latest forum postsMore »Gorogoro+ arena tournament on … gbtami Gorogoro+  2+15(b) tournament starts at UTC 2021.12.21 15:00 tomorrow,…About black and white shogi BOT YoBot_v2 Yes this error has been noted even in github and the issue is still op…Minishogi and much more! snettik Huge thanks for having chu shogi as a variant! That's exactly what I'v…Minishogi and much more! Nihongo-sansan @LVC \r There are already Weekly\\Monthly and Yearly Arenas. Which I fin…Minishogi and much more! LVC Now we need hourly minishogi arena tournaments!Minishogi and much more! shogi_235 THIS IS AMAZING! So many new features I was hoping forMinishogi and much more! Nihongo-sansan I'm stoked! Thanks Lishogi for this update.\r \r Now I am wondering if t…Minishogi and much more! Lasoo Incredible updates, thanks!Minishogi and much more! lideveloper Wow, Nice!Minishogi and much more! BOT YoBot_v2 Thanks for these great changes. Should try implementing minishogi for …Latest updatesMore »Minishogi and much more!First variant is now available on lishogi. But also other new features and many bug fixes.14 Dec 2021CSA supportImport and export CSA15 Oct 2021KIF Imports and ExportsKIF support is here! 19 Sep 2021DonateBecome a Lishogi PatronAbout LishogiFAQContactShogi resourcesTerms of ServicePrivacySource CodeAdsTwitterDiscordReconnecting"
# KifuExtractor.extract("https://shogidb2.com")         # => "将棋DB2 - 無料の棋譜サービス 将棋DB2世界最強の将棋の棋譜データベース - プロ棋士からコンピューター将棋まで将棋DB2最新の棋譜記事コメント各種棋譜floodgate棋戦別棋士別戦型別定跡・戦法棋書棋譜投稿動画将棋DB2 サービス概要将棋DB2はプロ棋士、コンピューターの棋譜が鑑賞でき、ユーザー同士でコミュニケーションできる新しい棋譜データベースサービスです。現在の収録棋譜数 棋譜投稿を受け付けています現在、 みなさまからの棋譜の投稿を受け付けております。棋譜投稿から投稿お願いします。最新の棋譜最新のプロ棋士の棋譜一覧です。ここで最新の棋譜をチェックしましょう。新着の棋譜新着のプロ棋士の棋譜一覧です。ここで新着の棋譜をチェックしましょう。最新のコメント最新の盤面コメント一覧です。最新のコメントをチェックしましょう。floodgateコンピューター将棋の対局場で有名なfloodgateの最新の棋譜一覧です。棋譜検索棋譜検索から棋戦名や対局者名など、さまざまな条件から棋譜を検索することができます。同一局面検索同一局面検索からsfenを指定して同一局面を検索することができます。棋士一覧棋士一覧から棋譜を探すことが出来ます。棋戦一覧棋戦一覧から棋譜を探すことが出来ます。戦型一覧戦型一覧から棋譜を探すことが出来ます。将棋DB2のアプリiOSとAndroidでご利用いただけます。 App Storeへ Google Playへ棋書コーナー棋書コーナーでは将棋関連の書籍や棋書を紹介しています。書評コーナー書評コーナーでは将棋関連の書籍や棋書への書評を書いたり、他のユーザーの書いた書評をご覧いただけます。棋譜投稿棋譜投稿ではみなさまからの棋譜の投稿を受け付けております。碁DB碁DBは囲碁の棋譜データベースサイトです。棋譜並べ動画棋譜並べ動画では評価値付きの棋譜並べ動画を鑑賞できます。shogidb2+floodgateshogidb2+floodgateでコンピューター将棋の自動対局場のfloodgateの運用を開始しました。関連コンテンツ将棋の棋譜データベースのサイトである将棋DB2はプロ棋士の名人戦、竜王戦、順位戦や奨励会の棋譜、女流棋士の棋譜、江戸時代の古典の棋譜、アマチュアの棋戦、floodgateなどのコンピューター将棋の棋譜を数多く掲載している最高峰の棋譜データベースです。また、棋譜は戦型別に分類されており、各種戦型の研究にも最適なサービスです。将棋DB2は棋譜のデータベースサイトであるだけではなく、棋譜の盤面にコメントを書き込みできるSNSの特性のある、棋譜のソーシャルサービスです。iOSやAndroidのアプリでも豊富な棋譜をお楽しみいただけます。Menu最新の棋譜新着の棋譜floodgateの棋譜棋譜検索定跡・戦法・戦型研究棋書棋譜投稿RSSフィードお問い合わせサポータープログラムプラバシーポリシーLinkiOSアプリAndroidアプリTwitterFacebookYouTubeチャンネルGithub碁DBBlog将棋道場一覧肉肉どっとこむ将棋DB2"
# KifuExtractor.extract("https://mainichi.jp/oshosen-kifu/220109.html").truncate(256)         # => "# --- Kifu for Windows (Pro) V6.65.60 棋譜ファイル ---\r\n対局ID：13141\r\n記録ID：61c9647da0dc5700033b6463\r\n開始日時：2022/01/09 09:00\r\n棋戦：第71期ALSOK杯王将戦七番勝負第１局\r\n戦型：相掛かり\r\n持ち時間：8時間\r\n消費時間：100▲477△479\r\n場所：静岡県掛川市「掛川城　二の丸茶室」\r\n備考：昼休前42手目6分\\n２日目昼休前59手目34分\\n封じ手時刻:18:05＜47手目＞\\n\r\n振り駒..."

# Rails::Html::Sanitizer.full_sanitizer.new.sanitize("<a>X</a>")

# ApplicationHelper.strip_tags("<a>X</a>") # =>
# ActionController::Base.helpers.strip_tags("<a>X</a>") # => "X"

# puts KifuExtractor.extract("https://lishogi.org/151jxej8juO1")
# puts KifuExtractor.extract("https://lishogi.org/151jxej8")
# puts WebAgent.raw_fetch("https://lishogi.org/game/export/151jxej8juO1?csa=1&clocks=0")
# puts WebAgent.raw_fetch("https://lishogi.org/game/export/151jxej8juO1?csa=1&clocks=0")

# p KifuExtractor.extract("https://lishogi.org/editor/ln5nl/2kp3R1/2l4p1/p1pg1+BP1p/9/PPP1PP3/1SN5P/1KG1G2+r1/L8_w_G2Pb3sn4p_1")

# p KifuExtractor.extract("原始棒銀")

# KifuExtractor.extract("https://www.shogi.or.jp/tsume_shogi/everyday/20221145.html") # => "# --- Kifu for Windows (Pro) V6.65.59 棋譜ファイル ---\n対局ID：0\n記録ID：\n開始日時：2018/07/08 17:05:38\n終了日時：2018/07/08 17:05:38\n先手消費時間加算：0\n後手消費時間加算：0\n封じ手手数：0\n手合割：平手\n後手の持駒：飛　角　金三　銀二　桂四　香三　歩十六\n  ９ ８ ７ ６ ５ ４ ３ ２ １\n+---------------------------+\n| ・ ・ ・ ・ ・ ・ ・ 銀v香|一\n| ・ ・ ・ ・ ・ 馬 ・ ・ ・|二\n| ・ ・ ・ ・ ・ ・ ・v歩v玉|三\n| ・ ・ ・ ・ ・v飛 歩 ・ ・|四\n| ・ ・ ・ ・ ・ ・ ・ ・ ・|五\n| ・ ・ ・ ・ ・ ・ ・ ・ ・|六\n| ・ ・ ・ ・ ・ ・ ・ ・ ・|七\n| ・ ・ ・ ・ ・ ・ ・ ・ ・|八\n| ・ ・ ・ ・ ・ ・ ・ ・ ・|九\n+---------------------------+\n先手の持駒：金　銀\n先手：\n後手：\n手数----指手---------消費時間--\n   1 ２二銀打     ( 0:00/00:00:00)\n   2 同　玉(13)   ( 0:00/00:00:00)\n   3 ３一馬(42)   ( 0:00/00:00:00)\n   4 同　玉(22)   ( 0:00/00:00:00)\n   5 ３二金打     ( 0:00/00:00:00)\n   6 詰み         ( 0:00/00:00:00)\nまで5手詰\n"

# KifuExtractor.extract("https://www.sponichi.co.jp/entertainment/news/2022/01/18/kiji/20220118c00041S01002000c.html") # => "▲2六歩 △3四歩 ▲7六歩 △4四歩 ▲4八銀 △9四歩 ▲9六歩 △3二銀 ▲5六歩 △4三銀 ▲5八金右 △5四歩 ▲6八玉 △3二金 ▲2五歩 △8四歩 ▲7八銀 △8五歩 ▲7七銀 △6二銀 ▲7八玉 △4一玉 ▲7九角 △7四歩 ▲3六歩 △4五歩 ▲4六歩 △5五歩 ▲4七銀 △5六歩 ▲4五歩 △7五歩 ▲同歩 △7三銀 ▲5六銀 △6四銀 ▲2四歩 △同歩 ▲2三歩 △同金 ▲2五歩 △8六歩 ▲同歩 △8八歩 ▲同角 △2五歩 ▲6六歩 △8七歩 ▲同玉 △8五歩 ▲同歩 △7五銀 ▲7六歩 △8六歩 ▲同銀 △同銀 ▲同玉 △9三桂 ▲9七桂 △3一角 ▲7七玉 △8五桂 ▲同桂 △同飛 ▲5五桂"

puts KifuExtractor.extract(<<~EOT)
開始日時：2021年08月18日(水) 13：30：43
終了日時：2021年08月18日(水) 13：33：09
手数----指手---------消費時間--
   1 ７六歩(77)( 0:01/00:00:01)
*#定跡手
*#推奨定跡: ▲２六歩   ▲７六歩   ▲６八銀
   2 ８四歩(83)( 0:01/00:00:01)
EOT
# >> 
