<!-- -*- compile-command: "scp piyo_shogi_test.html i:/var/www/shogi_web_production/current/public/system/; open https://www.shogi-extend.com/system/piyo_shogi_test" -*- -->
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=0" />
    <style>ol { display: flex; flex-direction: column; gap: 1rem; }</style>
  </head>
  <body>
    <h3>ぴよ将棋ディープリンク動作確認用</h3>
    <ol>
      <li>
        ◎<a href="piyoshogi://?num=3&viewpoint=black&game_name=%E5%85%B1%E6%9C%89%E5%B0%86%E6%A3%8B%E7%9B%A4&sfen=position%20sfen%20lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL%20b%20-%201%20moves%207g7f%203c3d%208h2b+">リンク</a>
        SFENは読み込める
      </li>
      <li>
        ◎<a href="piyoshogi://?num=3&url=https://www.shogi-extend.com/example_utf_8.kif">リンク</a>
        引数がないKIFのURLは読み込める
      </li>
      <li>
        ×<a href="piyoshogi://?num=3&url=https://www.shogi-extend.com/share-board.kif?turn=3&xbody=cG9zaXRpb24gc2ZlbiBsbnNna2dzbmwvMXI1YjEvcHBwcHBwcHBwLzkvOS85L1BQUFBQUFBQUC8xQjVSMS9MTlNHS0dTTkwgYiAtIDEgbW92ZXMgN2c3ZiAzYzNkIDhoMmIr">リンク</a>
        引数があるKIFのURLは読み込めない。「読み込みました」と出るが0手目までしか読み込めていない。おそらく turn や xbody パラメータが url パラメータの値として読み取られていない。(これが正しく読めないのは問題ない)
      </li>
      <li>
        △<a href="piyoshogi://?num=3&url=https%3A%2F%2Fwww.shogi-extend.com%2Fshare-board.kif%3Fturn%3D3%26xbody%3DcG9zaXRpb24gc2ZlbiBsbnNna2dzbmwvMXI1YjEvcHBwcHBwcHBwLzkvOS85L1BQUFBQUFBQUC8xQjVSMS9MTlNHS0dTTkwgYiAtIDEgbW92ZXMgN2c3ZiAzYzNkIDhoMmIr">リンク</a>
        上の問題に対処するため url パラメータに指定する値(URL全体)をエスケープしている<br>
        iOS 版ではエラーになる。「棋譜が読み込めませんでした 対応しない形式です」と表示される<br/>
        Android 版では問題なく読み込める。
      </li>
    </ol>
    <p>ぴよ将棋 iOS版, Android版ともに v4.9.6 で確認</p>
  </body>
</html>
