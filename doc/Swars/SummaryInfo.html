<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Swars::SummaryInfo
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Swars::SummaryInfo";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Swars.html" title="Swars (module)">Swars</a></span></span>
     &raquo; 
    <span class="title">SummaryInfo</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Swars::SummaryInfo
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Swars::SummaryInfo</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/swars/summary_info.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user-instance_method" title="#user (instance method)">#<strong>user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute user.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#basic_summary-instance_method" title="#basic_summary (instance method)">#<strong>basic_summary</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(user)  &#x21d2; SummaryInfo </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of SummaryInfo.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#secret_summary-instance_method" title="#secret_summary (instance method)">#<strong>secret_summary</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tactic_summary_for-instance_method" title="#tactic_summary_for (instance method)">#<strong>tactic_summary_for</strong>(key)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(user)  &#x21d2; <tt><span class='object_link'><a href="" title="Swars::SummaryInfo (class)">SummaryInfo</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of SummaryInfo</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/swars/summary_info.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span>
  <span class='ivar'>@user</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="user-instance_method">
  
    #<strong>user</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute user</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3
4
5</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/swars/summary_info.rb', line 3</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user'>user</span>
  <span class='ivar'>@user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="basic_summary-instance_method">
  
    #<strong>basic_summary</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/swars/summary_info.rb', line 129</span>

<span class='kw'>def</span> <span class='id identifier rubyid_basic_summary'>basic_summary</span>
  <span class='id identifier rubyid_stat'>stat</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>サンプル対局数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='label'>url:</span> <span class='id identifier rubyid_query_path'>query_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tag:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_user_key'>user_key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_judge_group_memberships'>judge_group_memberships</span><span class='lparen'>(</span><span class='symbol'>:win</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parcentage_set'>parcentage_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>勝率</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_win_lose_total_count'>win_lose_total_count</span><span class='comma'>,</span> <span class='label'>great_p:</span> <span class='id identifier rubyid_win_rate'>win_rate</span> <span class='op'>&gt;=</span> <span class='float'>0.6</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>格上</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:win</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>同格</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:win</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>格下</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:win</span><span class='rparen'>)</span>

  <span class='const'><span class='object_link'><a href="ChartTagInfo.html" title="Swars::ChartTagInfo (class)">ChartTagInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_main_scope'>main_scope</span><span class='period'>.</span><span class='id identifier rubyid_tagged_with'>tagged_with</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>on:</span> <span class='symbol'>:note_tags</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>&gt;=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>judge_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>win</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
      <span class='id identifier rubyid_rate'>rate</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_fdiv'>fdiv</span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_parcentage_set'>parcentage_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>の勝率</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>great_p:</span> <span class='id identifier rubyid_rate'>rate</span> <span class='op'>&gt;=</span> <span class='float'>0.6</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>格上</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:lose</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>同格</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:lose</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_win_range_for'>win_range_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='label'>win_range_key:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>格下</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>key:</span> <span class='symbol'>:lose</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_fdiv'>fdiv</span><span class='lparen'>(</span><span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
    <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>平均手数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>&lt;</span> <span class='int'>70</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>手</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>50</span><span class='comma'>,</span> <span class='int'>100</span><span class='comma'>,</span> <span class='int'>150</span><span class='comma'>,</span> <span class='int'>200</span><span class='comma'>,</span> <span class='const'>Float</span><span class='op'>::</span><span class='const'>INFINITY</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each_cons'>each_cons</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='op'>...</span><span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_range'>range</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span>
      <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'>手未満</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>手以上</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='comma'>,</span> <span class='label'>great_p:</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>&gt;=</span> <span class='int'>200</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="../JudgeInfo.html" title="JudgeInfo (class)">JudgeInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_judge_group_memberships'>judge_group_memberships</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_ms_group'>ms_group</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_summary_key'>summary_key</span><span class='comma'>,</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='op'>|</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='id identifier rubyid_summary_key'>summary_key</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># stat.delete(&quot;切断した&quot;)
</span>  <span class='comment'># suffix_add(stat)
</span>
  <span class='id identifier rubyid_stat'>stat</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="secret_summary-instance_method">
  
    #<strong>secret_summary</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/swars/summary_info.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_secret_summary'>secret_summary</span>
  <span class='id identifier rubyid_stat'>stat</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_judge_count_for'>judge_count_for</span><span class='lparen'>(</span><span class='symbol'>:lose</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span>
    <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_group'>ms_group</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切断した</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='comment'># count_set(stat, &quot;切断回数&quot;, c, alert_p: c.nonzero?, memberships: ms_a)
</span>    <span class='id identifier rubyid_parcentage_set'>parcentage_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切断率</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span><span class='comma'>,</span> <span class='label'>tooltip:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切断回数 / 負け数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_judge_count_for'>judge_count_for</span><span class='lparen'>(</span><span class='symbol'>:win</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span>
    <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_cheat_memberships'>cheat_memberships</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='comment'># count_set(stat, &quot;棋神召喚疑惑&quot;, c, alert_p: c.nonzero?, memberships: cheat_memberships)
</span>    <span class='id identifier rubyid_parcentage_set'>parcentage_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>棋神召喚疑惑率</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>alert_p:</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='id identifier rubyid_judge_count_for'>judge_count_for</span><span class='lparen'>(</span><span class='symbol'>:lose</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span>
    <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_group'>ms_group</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>投了した</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_parcentage_set'>parcentage_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>投了率</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_d'>d</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_fdiv'>fdiv</span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='float'>0.25</span><span class='comma'>,</span> <span class='label'>tooltip:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>投了回数 / 負け数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># turn = memberships.collect { |e| e.battle.turn_max }.max
</span>  <span class='comment'># count_set(stat, &quot;【#{rule_info.name}】最長手数&quot;, turn, alert_p: turn &amp;&amp; turn &gt;= 200, suffix: &quot;手&quot;)
</span>
  <span class='kw'>if</span> <span class='kw'>true</span>
    <span class='comment'># latest_record = user.battles.reorder(created_at: :desc).take
</span>    <span class='comment'># t = latest_record.created_at
</span>    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
    <span class='id identifier rubyid_n_days'>n_days</span> <span class='op'>=</span> <span class='int'>7</span>
    <span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span><span class='lparen'>(</span><span class='id identifier rubyid_n_days'>n_days</span><span class='period'>.</span><span class='id identifier rubyid_days'>days</span><span class='rparen'>)</span><span class='op'>..</span><span class='id identifier rubyid_t'>t</span>
    <span class='id identifier rubyid_avg'>avg</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_battles'>battles</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>created_at:</span> <span class='id identifier rubyid_range'>range</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_fdiv'>fdiv</span><span class='lparen'>(</span><span class='id identifier rubyid_n_days'>n_days</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>直近1週間での1日平均対局数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_avg'>avg</span><span class='comma'>,</span> <span class='label'>great_p:</span> <span class='id identifier rubyid_avg'>avg</span> <span class='op'>&gt;=</span> <span class='int'>10</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>戦</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="RuleInfo.html" title="Swars::RuleInfo (class)">RuleInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='op'>|</span>
    <span class='id identifier rubyid_ships'>ships</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_rule_info'>rule_info</span> <span class='op'>==</span> <span class='id identifier rubyid_rule_info'>rule_info</span> <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_related_time_p'>related_time_p</span>
        <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】最大長考</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>alert_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】最終着手の最長</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_judge_info'>judge_info</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='symbol'>:lose</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
        <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】最終着手に</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sec_to_human'>sec_to_human</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>以上かけて負け</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>詰ました</span><span class='tstring_end'>&quot;</span></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
        <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】1手詰を</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sec_to_human'>sec_to_human</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>以上かけて詰ました</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>詰ました</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_sec_list'>sec_list</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
          <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】1手詰勝ちのときの着手最長</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切れ負け</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_rest_sec'>rest_sec</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_rest_sec'>rest_sec</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
          <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】切れ負けるときの思考時間最長</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_ms_a'>ms_a</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切れ負け</span><span class='tstring_end'>&quot;</span></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_rest_sec'>rest_sec</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
        <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sec_to_human'>sec_to_human</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_leave_alone_limit'>leave_alone_limit</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>以上かけて切れ負け</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='label'>danger_p:</span> <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_nonzero?'>nonzero?</span><span class='comma'>,</span> <span class='label'>memberships:</span> <span class='id identifier rubyid_ms_a'>ms_a</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='comment'># e.summary_key == &quot;投了した&quot; || e.summary_key == &quot;詰まされた&quot; }.presence
</span>      <span class='comment'># if scope = ships.find_all { |e| e.judge_info.key == :lose }
</span>      <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>投了した</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_summary_key'>summary_key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>詰まされた</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_presence'>presence</span> <span class='comment'># { |e| e.judge_info.key == :lose } の判定だと切断負けも含まれてしまう
</span>      <span class='id identifier rubyid_tooltip'>tooltip</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>切断を除く</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_scope'>scope</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_min_by'>min_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_turn'>turn</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span>
          <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】負け最短手数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_turn'>turn</span><span class='comma'>,</span> <span class='label'>alert_p:</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_most_min_turn_max_limit'>most_min_turn_max_limit</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>手</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='comma'>,</span> <span class='label'>tooltip:</span> <span class='id identifier rubyid_tooltip'>tooltip</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_min_by'>min_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_total_seconds'>total_seconds</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_total_seconds'>total_seconds</span>
          <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】負け最短時間</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>alert_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_resignation_limit'>resignation_limit</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='comma'>,</span> <span class='label'>tooltip:</span> <span class='id identifier rubyid_tooltip'>tooltip</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_judge_info'>judge_info</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='symbol'>:win</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_presence'>presence</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_turn'>turn</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span>
          <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】勝ち最長手数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_turn'>turn</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&gt;=</span> <span class='int'>200</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>手</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_min_by'>min_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span> <span class='rbrace'>}</span>
          <span class='id identifier rubyid_turn'>turn</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span>
          <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】勝ち最短手数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_turn'>turn</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>手</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='symbol'>:ten_sec</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_total_seconds'>total_seconds</span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_sec'>sec</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_total_seconds'>total_seconds</span>
            <span class='id identifier rubyid_sec_set'>sec_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】勝ち最長時間</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_sec'>sec</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_sec'>sec</span> <span class='op'>&gt;=</span> <span class='int'>10</span><span class='period'>.</span><span class='id identifier rubyid_minutes'>minutes</span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_ms'>ms</span> <span class='op'>=</span> <span class='id identifier rubyid_ships'>ships</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_turn'>turn</span> <span class='op'>=</span> <span class='id identifier rubyid_ms'>ms</span><span class='period'>.</span><span class='id identifier rubyid_battle'>battle</span><span class='period'>.</span><span class='id identifier rubyid_turn_max'>turn_max</span>
        <span class='id identifier rubyid_count_set'>count_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stat'>stat</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>【</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule_info'>rule_info</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>】最長手数</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_turn'>turn</span><span class='comma'>,</span> <span class='label'>warn_p:</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_turn'>turn</span> <span class='op'>&gt;=</span> <span class='int'>200</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>手</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>membership:</span> <span class='id identifier rubyid_ms'>ms</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='comment'># scope = ships.find_all { |e| e.summary_key == &quot;投了した&quot; }
</span>      <span class='comment'># most_min_turn_max = scope.collect { |e| e.sec_total }.min
</span>      <span class='comment'># sec_set(stat, &quot;【#{rule_info.name}】1手詰勝ちのときの着手最長&quot;, sec, warn_p: sec &amp;&amp; sec &lt; rule_info.resignation_limit)
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_stat'>stat</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tactic_summary_for-instance_method">
  
    #<strong>tactic_summary_for</strong>(key)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190
191
192
193
194
195
196
197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/swars/summary_info.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tactic_summary_for'>tactic_summary_for</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_memberships'>memberships</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:&quot;#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>_tag_list</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:itself</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_transform_values'>transform_values</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:size</span><span class='rparen'>)</span> <span class='comment'># TODO: ruby 2.6 の新しいメソッドで置き換えれるはず
</span>  <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='op'>-</span><span class='id identifier rubyid_v'>v</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span><span class='op'>|</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_query_path'>query_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_user_key'>user_key</span><span class='embexpr_end'>}</span><span class='tstring_content'> muser:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_user_key'>user_key</span><span class='embexpr_end'>}</span><span class='tstring_content'> ms_tag:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>import_skip:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'>Bioshogi</span><span class='op'>::</span><span class='const'>TacticInfo</span><span class='period'>.</span><span class='id identifier rubyid_flat_lookup'>flat_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_h'>h</span><span class='period'>.</span><span class='id identifier rubyid_link_to'>link_to</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_url_helpers'>url_helpers</span><span class='period'>.</span><span class='id identifier rubyid_url_for'>url_for</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:tactic_note</span><span class='comma'>,</span> <span class='label'>id:</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='label'>only_path:</span> <span class='kw'>true</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:class</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no-decoration</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_h'>h</span><span class='period'>.</span><span class='id identifier rubyid_link_to'>link_to</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Oct 25 16:12:10 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.1).
</div>

    </div>
  </body>
</html>