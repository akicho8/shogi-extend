#!/usr/bin/env ruby
require File.expand_path('../../config/environment', __FILE__)

list = ActiveRecord::Base.connection.tables.sort.flat_map do |table|
  ActiveRecord::Base.connection.indexes(table).collect do |obj|
    [:table, :name, :unique, :columns, :lengths, :orders, :opclasses, :where, :type, :using, :comment].inject({}) { |a, e| a.merge(e => obj.send(e)) }
  end
end
tp list
# >> ["/Users/ikeda/src/shogi_web/config/initializers/0180_active_model_serializers.rb:11", nil, :ams_sr]
# >> |----------------------------+--------------------------------------------------------------+--------+-----------------------------------------------------------------------------------+---------+--------+-----------+-------+------+-------+---------|
# >> | table                      | name                                                         | unique | columns                                                                           | lengths | orders | opclasses | where | type | using | comment |
# >> |----------------------------+--------------------------------------------------------------+--------+-----------------------------------------------------------------------------------+---------+--------+-----------+-------+------+-------+---------|
# >> | active_storage_attachments | index_active_storage_attachments_uniqueness                  | true   | ["record_type", "record_id", "name", "blob_id"]                                   | {}      | {}     | {}        |       |      | btree |         |
# >> | active_storage_attachments | index_active_storage_attachments_on_blob_id                  | false  | ["blob_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | active_storage_blobs       | index_active_storage_blobs_on_key                            | true   | ["key"]                                                                           | {}      | {}     | {}        |       |      | btree |         |
# >> | converted_infos            | index_converted_infos_on_convertable_type_and_convertable_id | false  | ["convertable_type", "convertable_id"]                                            | {}      | {}     | {}        |       |      | btree |         |
# >> | converted_infos            | index_converted_infos_on_text_format                         | false  | ["text_format"]                                                                   | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_chat_messages        | index_fanta_chat_messages_on_battle_id                       | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_chat_messages        | index_fanta_chat_messages_on_user_id                         | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_lobby_messages       | index_fanta_lobby_messages_on_user_id                        | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_memberships          | index_fanta_memberships_on_battle_id                         | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_memberships          | index_fanta_memberships_on_user_id                           | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_memberships          | index_fanta_memberships_on_location_key                      | false  | ["location_key"]                                                                  | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_memberships          | index_fanta_memberships_on_position                          | false  | ["position"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_users                | index_fanta_users_on_current_battle_id                       | false  | ["current_battle_id"]                                                             | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_users                | index_fanta_users_on_lifetime_key                            | false  | ["lifetime_key"]                                                                  | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_users                | index_fanta_users_on_platoon_key                             | false  | ["platoon_key"]                                                                   | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_users                | index_fanta_users_on_self_preset_key                         | false  | ["self_preset_key"]                                                               | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_users                | index_fanta_users_on_oppo_preset_key                         | false  | ["oppo_preset_key"]                                                               | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_watch_ships          | index_fanta_watch_ships_on_battle_id                         | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | fanta_watch_ships          | index_fanta_watch_ships_on_user_id                           | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | free_battles               | index_free_battles_on_unique_key                             | true   | ["key"]                                                                    | {}      | {}     | {}        |       |      | btree |         |
# >> | general_battles            | index_general_battles_on_battle_key                          | true   | ["key"]                                                                    | {}      | {}     | {}        |       |      | btree |         |
# >> | general_battles            | index_general_battles_on_battle_state_key                    | false  | ["battle_state_key"]                                                              | {}      | {}     | {}        |       |      | btree |         |
# >> | general_memberships        | general_memberships_126b7e47a41d11c2                         | true   | ["battle_id", "location_key"]                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | general_memberships        | index_general_memberships_on_battle_id                       | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | general_memberships        | index_general_memberships_on_judge_key                       | false  | ["judge_key"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | general_memberships        | index_general_memberships_on_location_key                    | false  | ["location_key"]                                                                  | {}      | {}     | {}        |       |      | btree |         |
# >> | general_memberships        | index_general_memberships_on_position                        | false  | ["position"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | general_users              | index_general_users_on_name                                  | true   | ["name"]                                                                          | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_access_logs          | index_swars_access_logs_on_battle_id                         | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_battles              | index_swars_battles_on_battle_key                            | true   | ["key"]                                                                    | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_battles              | index_swars_battles_on_rule_key                              | false  | ["rule_key"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_battles              | index_swars_battles_on_battle_state_key                      | false  | ["battle_state_key"]                                                              | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_battles              | index_swars_battles_on_win_user_id                           | false  | ["win_user_id"]                                                                   | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_grades               | index_swars_grades_on_unique_key                             | true   | ["key"]                                                                    | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_grades               | index_swars_grades_on_priority                               | false  | ["priority"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | memberships_sbri_lk                                          | true   | ["battle_id", "location_key"]                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | memberships_sbri_sbui                                        | true   | ["battle_id", "user_id"]                                                          | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_battle_id                         | false  | ["battle_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_user_id                           | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_grade_id                          | false  | ["grade_id"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_judge_key                         | false  | ["judge_key"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_location_key                      | false  | ["location_key"]                                                                  | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_memberships          | index_swars_memberships_on_position                          | false  | ["position"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_search_logs          | index_swars_search_logs_on_user_id                           | false  | ["user_id"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_users                | index_swars_users_on_user_key                                | true   | ["user_key"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | swars_users                | index_swars_users_on_grade_id                                | false  | ["grade_id"]                                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | taggings_idx                                                 | true   | ["tag_id", "taggable_id", "taggable_type", "context", "tagger_id", "tagger_type"] | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_taggable_id_and_taggable_type_and_context  | false  | ["taggable_id", "taggable_type", "context"]                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_tag_id                                     | false  | ["tag_id"]                                                                        | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_taggable_id                                | false  | ["taggable_id"]                                                                   | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_taggable_type                              | false  | ["taggable_type"]                                                                 | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_tagger_id                                  | false  | ["tagger_id"]                                                                     | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_context                                    | false  | ["context"]                                                                       | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | index_taggings_on_tagger_id_and_tagger_type                  | false  | ["tagger_id", "tagger_type"]                                                      | {}      | {}     | {}        |       |      | btree |         |
# >> | taggings                   | taggings_idy                                                 | false  | ["taggable_id", "taggable_type", "tagger_id", "context"]                          | {}      | {}     | {}        |       |      | btree |         |
# >> | tags                       | index_tags_on_name                                           | true   | ["name"]                                                                          | {}      | {}     | {}        |       |      | btree |         |
# >> |----------------------------+--------------------------------------------------------------+--------+-----------------------------------------------------------------------------------+---------+--------+-----------+-------+------+-------+---------|
