#!/usr/bin/env ruby
require File.expand_path('../../../config/environment', __FILE__)
Swars::Battle.destroy_all
Swars::Battle.user_import(user_key: "itoshinTV", verbose: false)
tp Swars::MembershipExtra
tp Swars.info

# remakeで回復する
Swars::MembershipExtra.first.update!(used_piece_counts: {})
Swars::Battle.all.each(&:remake)
tp Swars::MembershipExtra

# >> |----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
# >> | id | membership_id | used_piece_counts                                                                   | created_at                | updated_at                |
# >> |----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
# >> | 79 |           207 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 80 |           208 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 81 |           209 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 82 |           210 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 83 |           211 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 84 |           212 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> |----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
# >> |------------------------+-------+--------|
# >> | model                  | count | 最終ID |
# >> |------------------------+-------+--------|
# >> | Swars::Battle          |     3 |    107 |
# >> | Swars::Membership      |     6 |    212 |
# >> | Swars::MembershipExtra |     6 |     84 |
# >> | Swars::Grade           |    40 |     40 |
# >> | Swars::User            |    28 |     28 |
# >> |------------------------+-------+--------|
# >> ...|----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
# >> | id | membership_id | used_piece_counts                                                                   | created_at                | updated_at                |
# >> |----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
# >> | 79 |           207 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 80 |           208 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 81 |           209 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 82 |           210 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 83 |           211 | {"B0"=>5, "G0"=>4, "K0"=>4, "L0"=>7, "N0"=>1, "P0"=>17, "P1"=>2, "R0"=>4, "S0"=>11} | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> | 84 |           212 | {"B0"=>7, "G0"=>4, "K0"=>6, "L0"=>6, "N0"=>1, "P0"=>18, "P1"=>1, "R0"=>2, "S0"=>9}  | 2021-11-07 18:09:55 +0900 | 2021-11-07 18:09:55 +0900 |
# >> |----+---------------+-------------------------------------------------------------------------------------+---------------------------+---------------------------|
