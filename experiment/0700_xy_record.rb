#!/usr/bin/env ruby
require File.expand_path('../../config/environment', __FILE__)

XyRuleInfo.clear_all

XyRecord.destroy_all
XyRecord.create!(xy_rule_key: "xy_rule1", entry_name: "(name1)", spent_msec: 1.123, x_count: 0)
XyRecord.create!(xy_rule_key: "xy_rule1", entry_name: "(name1)", spent_msec: 2.123, x_count: 0)
XyRecord.create!(xy_rule_key: "xy_rule1", entry_name: "(name1)", spent_msec: 3.123, x_count: 0)

tp XyRecord.all.collect { |e| {id: e.id, page: e.ranking_page } }

tp XyRuleInfo.rule_list

tp XyRuleInfo[:xy_rule1].xy_records

# >> |----+------|
# >> | id | page |
# >> |----+------|
# >> | 74 |    1 |
# >> | 75 |    1 |
# >> | 76 |    2 |
# >> |----+------|
# >> |------------+-------+-------------+------------------+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
# >> | key        | name  | o_count_max | development_only | code | xy_records                                                                                                                                                                                                                                                          |
# >> |------------+-------+-------------+------------------+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
# >> | xy_rule1   | 1問   |           1 | false            |    0 | [{"id"=>74, "colosseum_user_id"=>nil, "entry_name"=>"(name1)", "summary"=>nil, "xy_rule_key"=>"xy_rule1", "x_count"=>0, "spent_msec"=>1.123, "created_at"=>Wed, 07 Aug 2019 16:50:15 JST +09:00, "updated_at"=>Wed, 07 Aug 2019 16:50:15 JST +09:00, "rank"=>1},... |
# >> | xy_rule2   | 2問   |           2 | true             |    1 | []                                                                                                                                                                                                                                                                  |
# >> | xy_rule10  | 10問  |          10 | false            |    2 | []                                                                                                                                                                                                                                                                  |
# >> | xy_rule30  | 30問  |          30 | false            |    3 | []                                                                                                                                                                                                                                                                  |
# >> | xy_rule50  | 50問  |          50 | false            |    4 | []                                                                                                                                                                                                                                                                  |
# >> | xy_rule100 | 100問 |         100 | false            |    5 | []                                                                                                                                                                                                                                                                  |
# >> |------------+-------+-------------+------------------+------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
# >> |----+-------------------+------------+---------+-------------+---------+------------+---------------------------+---------------------------+------|
# >> | id | colosseum_user_id | entry_name | summary | xy_rule_key | x_count | spent_msec | created_at                | updated_at                | rank |
# >> |----+-------------------+------------+---------+-------------+---------+------------+---------------------------+---------------------------+------|
# >> | 74 |                   | (name1)    |         | xy_rule1    |       0 |      1.123 | 2019-08-07 16:50:15 +0900 | 2019-08-07 16:50:15 +0900 |    1 |
# >> | 75 |                   | (name1)    |         | xy_rule1    |       0 |      2.123 | 2019-08-07 16:50:15 +0900 | 2019-08-07 16:50:15 +0900 |    2 |
# >> | 76 |                   | (name1)    |         | xy_rule1    |       0 |      3.123 | 2019-08-07 16:50:16 +0900 | 2019-08-07 16:50:16 +0900 |    3 |
# >> |----+-------------------+------------+---------+-------------+---------+------------+---------------------------+---------------------------+------|
